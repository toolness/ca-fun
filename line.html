<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html, body {
  font-family: sans-serif;
}
</style>
<title>Line Test</title>
<h1>Line Test</h1>
<script src="p5.js"></script>
<script src="grid.js"></script>
<script>
var grid;
var lineEndpoints = [];

function setup() {
  var i;

  grid = new Grid({
    width: 32,
    squareSize: 8
  });
  grid.createCanvas();

  for (i = 0; i < grid.width; i++)
    lineEndpoints.push([i, 0]);
  for (i = 0; i < grid.width; i++)
    lineEndpoints.push([grid.width - 1, i]);
  for (i = grid.width - 1; i > 0; i--)
    lineEndpoints.push([i, grid.width - 1]);
  for (i = grid.width - 1; i > 0; i--)
    lineEndpoints.push([0, i]);

  frameRate(30);
}

function drawLine(grid, x1, y1, x2, y2) {
  var slope = Math.abs((y1 - y2) / (x1 - x2));
  var y = y1;
  var x = x1;
  var xDir = (x2 >= x1) ? 1 : -1;
  var yDir = (y2 >= y1) ? 1 : -1;

  if (Math.abs(slope) === Infinity) {
    while (y != y2) {
      grid.drawSquare(x, y, "white");
      y += yDir;
    }
  } else if (slope <= 1) {
    while (x != x2) {
      grid.drawSquare(x, Math.floor(y), "white");
      y += slope * yDir;
      x += xDir;
    }
  } else if (slope > 1) {
    while (y != y2) {
      grid.drawSquare(Math.floor(x), y, "white");
      x += 1 / slope * xDir;
      y += yDir;
    }
  }

  grid.drawSquare(x2, y2, "white");
}

function draw() {
  var i = frameCount % (lineEndpoints.length);
  var endpoint = lineEndpoints[i];

  grid.draw();
  drawLine(grid, grid.width / 2, grid.width / 2, endpoint[0], endpoint[1]);
}
</script>
